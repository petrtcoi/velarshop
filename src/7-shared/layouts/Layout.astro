---
import ShoppingCartWidget from '@widgets/order/ShoppingCartWidget'
import Footer from './components/Footer.astro'
import Navigation from './components/Navigation.astro'
import '@shared/styles/global.css'

export interface Props {
	title?: string
	description?: string
	paddings?: boolean
	hideShoppingCartWidgt?: boolean
}

const canonicalURL = new URL(Astro.url.pathname, Astro.site)

const {
	title = 'Velar дизайн-радиаторы отопления | VelarShop.ru',
	description = 'Фирменный магазин дизайнерских радиаторов отопления Velar. Доставка по России. Официальная гарантия. Полный модельный ряд и быстрые сроки производства.',
	paddings = true,
	hideShoppingCartWidgt = false,
} = Astro.props as Props as Props
---

<!DOCTYPE html>
<html lang='ru'>
	<head>
		<link
			rel={'canonical'}
			href={canonicalURL.toString().split('?')[0].split('#')[0]}
		/>
		<meta charset='UTF-8' />
		<meta
			name='viewport'
			content='width=device-width'
		/>
		<link
			rel='apple-touch-icon'
			sizes='120x120'
			href='/favicons/apple-touch-icon.png'
		/>
		<link
			rel='icon'
			type='image/png'
			sizes='32x32'
			href='/favicons/favicon-32x32.png'
		/>
		<link
			rel='icon'
			type='image/png'
			sizes='16x16'
			href='/favicons/favicon-16x16.png'
		/>
		<link
			rel='icon'
			href='/favicons/safari-pinned-tab.svg'
			type='image/x-icon'
		/>
		<meta
			name='msapplication-TileColor'
			content='#da532c'
		/>
		<meta
			name='theme-color'
			content='#ffffff'
		/>
		<meta
			name='generator'
			content={Astro.generator}
		/>

		<title>{title}</title>
		<meta
			name='description'
			content={description}
		/>
		<!-- Yandex.Metrika counter -->
		<script type='text/javascript'>
			setTimeout(() => {
				;(function (m, e, t, r, i, k, a) {
					m[i] =
						m[i] ||
						function () {
							;(m[i].a = m[i].a || []).push(arguments)
						}
					m[i].l = 1 * new Date()
					for (var j = 0; j < document.scripts.length; j++) {
						if (document.scripts[j].src === r) {
							return
						}
					}
					;(k = e.createElement(t)),
						(a = e.getElementsByTagName(t)[0]),
						(k.async = 1),
						(k.src = r),
						a.parentNode.insertBefore(k, a)
				})(window, document, 'script', 'https://mc.yandex.ru/metrika/tag.js', 'ym')

				ym(93362045, 'init', {
					clickmap: true,
					trackLinks: true,
					accurateTrackBounce: true,
				})
			}, 5000)
		</script>
		<noscript
			><div>
				<img
					src='https://mc.yandex.ru/watch/93362045'
					style='position:absolute; left:-9999px;'
					alt='yandex'
				/>
			</div></noscript
		>

		<!-- /Top.Mail.Ru counter -->

		<!-- Top.Mail.Ru counter -->
		<script type='text/javascript'>
			var _tmr = window._tmr || (window._tmr = [])
			_tmr.push({ id: '3549752', type: 'pageView', start: new Date().getTime() })
			;(function (d, w, id) {
				if (d.getElementById(id)) return
				var ts = d.createElement('script')
				ts.type = 'text/javascript'
				ts.async = true
				ts.id = id
				ts.src = 'https://top-fwz1.mail.ru/js/code.js'
				var f = function () {
					var s = d.getElementsByTagName('script')[0]
					s.parentNode.insertBefore(ts, s)
				}
				if (w.opera == '[object Opera]') {
					d.addEventListener('DOMContentLoaded', f, false)
				} else {
					f()
				}
			})(document, window, 'tmr-code')
		</script>
		<noscript
			><div>
				<img
					src='https://top-fwz1.mail.ru/counter?id=3549752;js=na'
					style='position:absolute;left:-9999px;'
					alt='Top.Mail.Ru'
				/>
			</div></noscript
		>
		<!-- /Top.Mail.Ru counter -->

		<!-- Google Tag Manager -->
		<script>
			;(function (w, d, s, l, i) {
				w[l] = w[l] || []
				w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' })
				var f = d.getElementsByTagName(s)[0],
					j = d.createElement(s),
					dl = l != 'dataLayer' ? '&l=' + l : ''
				j.async = true
				j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl
				f.parentNode.insertBefore(j, f)
			})(window, document, 'script', 'dataLayer', 'GTM-WXHQCMD7')
		</script>
		<!-- End Google Tag Manager -->
	</head>
	<body class='text-neutral-900 dark:text-neutral-200 bg-white dark:bg-neutral-800'>
		<!-- Google Tag Manager (noscript) -->
		<noscript
			><iframe
				src='https://www.googletagmanager.com/ns.html?id=GTM-WXHQCMD7'
				height='0'
				width='0'
				style='display:none;visibility:hidden'
			></iframe></noscript
		>
		<!-- End Google Tag Manager (noscript) -->
		{hideShoppingCartWidgt === false && <ShoppingCartWidget client:load />}
		<Navigation />
		<main class:list={[{ 'max-w-6xl mx-auto p-3 md:p-5 lg:px-10 xl:px-0': paddings }, { 'p-0 m-0': !paddings }]}>
			<slot />
		</main>
		<Footer />


		<!-- START Cookie-Alert -->
<style>
	#cookie_note {
    display: none;position: fixed;z-index:100;
    bottom: 15px;left: 50%; max-width: 90%;transform: translateX(-50%);
    padding: 20px;background-color: white;
    border-radius: 4px;box-shadow: 2px 3px 10px rgba(0, 0, 0, 0.4);	
	}
	#cookie_note p{margin: 0;font-size: 0.7rem;text-align: left;color: black;}

	.cookie_accept {min-width: 100px; font-size: 0.8rem; border: 1px solid black; border-radius: 8px; padding: 5px 10px; }
	.cookie_accept:hover {background-color: black; color: white; border: 1px solid black;}
	.privacy_link {text-decoration: underline;}
	.privacy_link:hover {color: black; text-decoration: none;}
	@media (min-width: 576px){#cookie_note.show{display: flex;}}
	@media (max-width: 575px){#cookie_note.show{display: none;text-align: left;}}
</style>

<div id="cookie_note">
    <p>Мы используем файлы cookies для улучшения работы сайта. Оставаясь на нашем сайте, вы соглашаетесь с условиями
        использования файлов cookies. Чтобы ознакомиться с нашими Положениями о конфиденциальности, сборе персональных данных и об использовании
        файлов cookie, <a href="/privacy" target="_blank" class="privacy_link">нажмите здесь</a>.</p>
    <button class="cookie_accept">Я согласен</button>
</div>

<script>
    function setCookie(name: string, value: string, days: number) {
        let expires = "";
        if (days) {
            let date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getCookie(name: string) {
        let matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"));
        return matches ? decodeURIComponent(matches[1]) : undefined;
    }
    function checkCookies() {
        let cookieNote = document.getElementById('cookie_note');
				if (!cookieNote) return
        let cookieBtnAccept = cookieNote.querySelector('.cookie_accept');
				if (!cookieBtnAccept) return

        // Если куки cookies_policy нет или она просрочена, то показываем уведомление
        if (!getCookie('cookies_policy')) {
            cookieNote.classList.add('show');
        }

        // При клике на кнопку устанавливаем куку cookies_policy на один год
        cookieBtnAccept.addEventListener('click', function () {
            setCookie('cookies_policy', 'true', 365);
            cookieNote.classList.remove('show');
        });
    }
    checkCookies();
</script>



<!-- END Cookie-Alert -->
	</body>
</html>
